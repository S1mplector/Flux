<ui:FluentWindow x:Class="Flux.Presentation.Settings.WidgetsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        Title="Widget Manager" Width="750" Height="550" WindowStartupLocation="CenterScreen"
        ExtendsContentIntoTitleBar="True" WindowBackdropType="Mica">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Title Bar -->
        <ui:TitleBar Grid.Row="0" Title="Widget Manager" ShowMaximize="False">
            <ui:TitleBar.Icon>
                <ui:ImageIcon Source="pack://application:,,,/Resources/icon.png" Width="16" Height="16"/>
            </ui:TitleBar.Icon>
        </ui:TitleBar>
        
        <!-- Main Content -->
        <Grid Grid.Row="1" Margin="16,0,16,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="220"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Widget List -->
            <ui:Card Grid.Column="0" Margin="0,0,8,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Active Widgets" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <ListBox x:Name="WidgetList" Grid.Row="1" SelectionChanged="WidgetList_SelectionChanged" Background="Transparent" BorderThickness="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox IsChecked="{Binding IsEnabled}" Checked="WidgetEnabled_Changed" Unchecked="WidgetEnabled_Changed" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="{Binding DisplayName}" Margin="8,0,0,0" VerticalAlignment="Center"/>
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,8,0,0">
                        <ComboBox x:Name="AddWidgetTypeCombo" Width="120">
                            <ComboBoxItem Content="Clock" Tag="clock"/>
                            <ComboBoxItem Content="Date" Tag="date"/>
                            <ComboBoxItem Content="System Info" Tag="systeminfo"/>
                        </ComboBox>
                        <ui:Button x:Name="AddWidgetButton" Content="Add" Appearance="Primary" Margin="8,0,0,0" Click="AddWidget_Click"/>
                    </StackPanel>
                </Grid>
            </ui:Card>
            
            <!-- Widget Settings Panel -->
            <ui:Card Grid.Column="1" Margin="8,0,0,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="SettingsPanel">
                        <TextBlock x:Name="NoSelectionText" Text="Select a widget to configure" Opacity="0.5" HorizontalAlignment="Center" Margin="0,40,0,0"/>
                        
                        <!-- Common Settings -->
                        <StackPanel x:Name="CommonSettings" Visibility="Collapsed">
                            <TextBlock Text="Position &amp; Size" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,12"/>
                            
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Anchor" VerticalAlignment="Center" Opacity="0.8"/>
                                <ComboBox x:Name="AnchorCombo" Grid.Column="1" SelectionChanged="AnchorCombo_SelectionChanged">
                                    <ComboBoxItem Content="Top Left" Tag="0"/>
                                    <ComboBoxItem Content="Top Center" Tag="1"/>
                                    <ComboBoxItem Content="Top Right" Tag="2"/>
                                    <ComboBoxItem Content="Middle Left" Tag="3"/>
                                    <ComboBoxItem Content="Center" Tag="4"/>
                                    <ComboBoxItem Content="Middle Right" Tag="5"/>
                                    <ComboBoxItem Content="Bottom Left" Tag="6"/>
                                    <ComboBoxItem Content="Bottom Center" Tag="7"/>
                                    <ComboBoxItem Content="Bottom Right" Tag="8"/>
                                </ComboBox>
                            </Grid>
                            
                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="50"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="X Offset" VerticalAlignment="Center" Opacity="0.8"/>
                                <Slider x:Name="XOffsetSlider" Grid.Column="1" Minimum="-500" Maximum="500" Margin="8,0" ValueChanged="PositionSlider_ValueChanged"/>
                                <ui:TextBox x:Name="XOffsetValue" Grid.Column="2" IsReadOnly="True"/>
                            </Grid>
                            
                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="50"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Y Offset" VerticalAlignment="Center" Opacity="0.8"/>
                                <Slider x:Name="YOffsetSlider" Grid.Column="1" Minimum="-500" Maximum="500" Margin="8,0" ValueChanged="PositionSlider_ValueChanged"/>
                                <ui:TextBox x:Name="YOffsetValue" Grid.Column="2" IsReadOnly="True"/>
                            </Grid>
                            
                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="50"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Width" VerticalAlignment="Center" Opacity="0.8"/>
                                <Slider x:Name="WidthSlider" Grid.Column="1" Minimum="0" Maximum="800" Margin="8,0" ValueChanged="SizeSlider_ValueChanged"/>
                                <ui:TextBox x:Name="WidthValue" Grid.Column="2" IsReadOnly="True"/>
                            </Grid>
                            
                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="50"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Height" VerticalAlignment="Center" Opacity="0.8"/>
                                <Slider x:Name="HeightSlider" Grid.Column="1" Minimum="0" Maximum="400" Margin="8,0" ValueChanged="SizeSlider_ValueChanged"/>
                                <ui:TextBox x:Name="HeightValue" Grid.Column="2" IsReadOnly="True"/>
                            </Grid>

                            <!-- Clock-specific settings -->
                            <StackPanel x:Name="ClockSettings" Visibility="Collapsed" Margin="0,20,0,0">
                                <TextBlock Text="Clock Settings" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,12"/>
                                <CheckBox x:Name="Clock24Hour" Content="Use 24-hour format" Checked="ClockSetting_Changed" Unchecked="ClockSetting_Changed"/>
                                <CheckBox x:Name="ClockShowSeconds" Content="Show seconds" Margin="0,8,0,0" Checked="ClockSetting_Changed" Unchecked="ClockSetting_Changed"/>
                                <Grid Margin="0,12,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Font size" VerticalAlignment="Center" Opacity="0.8"/>
                                    <Slider x:Name="ClockFontSize" Grid.Column="1" Minimum="12" Maximum="120" Margin="8,0" ValueChanged="ClockSetting_Changed"/>
                                    <TextBlock x:Name="ClockFontSizeValue" Grid.Column="2" Text="48" VerticalAlignment="Center"/>
                                </Grid>
                            </StackPanel>

                            <!-- Date-specific settings -->
                            <StackPanel x:Name="DateSettings" Visibility="Collapsed" Margin="0,20,0,0">
                                <TextBlock Text="Date Settings" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,12"/>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Format" VerticalAlignment="Center" Opacity="0.8"/>
                                    <ComboBox x:Name="DateFormatCombo" Grid.Column="1" SelectionChanged="DateFormat_Changed">
                                        <ComboBoxItem Content="dddd, MMMM d, yyyy" Tag="dddd, MMMM d, yyyy"/>
                                        <ComboBoxItem Content="MMMM d, yyyy" Tag="MMMM d, yyyy"/>
                                        <ComboBoxItem Content="d MMMM yyyy" Tag="d MMMM yyyy"/>
                                        <ComboBoxItem Content="yyyy-MM-dd" Tag="yyyy-MM-dd"/>
                                        <ComboBoxItem Content="dd/MM/yyyy" Tag="dd/MM/yyyy"/>
                                        <ComboBoxItem Content="MM/dd/yyyy" Tag="MM/dd/yyyy"/>
                                    </ComboBox>
                                </Grid>
                                <Grid Margin="0,8,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Font size" VerticalAlignment="Center" Opacity="0.8"/>
                                    <Slider x:Name="DateFontSize" Grid.Column="1" Minimum="10" Maximum="72" Margin="8,0" ValueChanged="DateSetting_Changed"/>
                                    <TextBlock x:Name="DateFontSizeValue" Grid.Column="2" Text="24" VerticalAlignment="Center"/>
                                </Grid>
                            </StackPanel>

                            <!-- SystemInfo-specific settings -->
                            <StackPanel x:Name="SystemInfoSettings" Visibility="Collapsed" Margin="0,20,0,0">
                                <TextBlock Text="System Info Settings" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,12"/>
                                <CheckBox x:Name="SysShowCpu" Content="Show CPU usage" Checked="SysInfoSetting_Changed" Unchecked="SysInfoSetting_Changed"/>
                                <CheckBox x:Name="SysShowRam" Content="Show RAM usage" Margin="0,8,0,0" Checked="SysInfoSetting_Changed" Unchecked="SysInfoSetting_Changed"/>
                                <CheckBox x:Name="SysShowBars" Content="Show progress bars" Margin="0,8,0,0" Checked="SysInfoSetting_Changed" Unchecked="SysInfoSetting_Changed"/>
                            </StackPanel>

                            <ui:Button x:Name="DeleteWidgetButton" Content="Delete Widget" Appearance="Danger" Margin="0,24,0,0" HorizontalAlignment="Left" Click="DeleteWidget_Click"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </ui:Card>
        </Grid>
        
        <!-- Bottom buttons -->
        <Border Grid.Row="2" Background="{ui:ThemeResource ControlFillColorDefaultBrush}" Padding="16,12">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <ui:Button x:Name="CloseButton" Content="Close" Appearance="Secondary" Width="100" Click="Close_Click"/>
                <ui:Button x:Name="SaveButton" Content="Save" Appearance="Primary" Width="100" Margin="8,0,0,0" Click="Save_Click"/>
            </StackPanel>
        </Border>
    </Grid>
</ui:FluentWindow>
