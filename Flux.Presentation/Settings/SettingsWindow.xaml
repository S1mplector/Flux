<ui:FluentWindow x:Class="Flux.Presentation.Settings.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        Title="Flux Settings" Width="650" Height="700" MinWidth="550" MinHeight="500" 
        WindowStartupLocation="CenterScreen"
        ExtendsContentIntoTitleBar="True"
        WindowBackdropType="Mica">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Title Bar -->
        <ui:TitleBar Grid.Row="0" Title="Flux Settings" ShowMaximize="False">
            <ui:TitleBar.Icon>
                <ui:ImageIcon Source="pack://application:,,,/Resources/icon.png" Width="16" Height="16"/>
            </ui:TitleBar.Icon>
        </ui:TitleBar>
        
        <!-- Main Content with Navigation -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="180"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Navigation Menu -->
            <ui:NavigationView x:Name="NavigationView" Grid.Column="0" PaneDisplayMode="Left" IsBackButtonVisible="Collapsed" IsPaneToggleVisible="False" OpenPaneLength="180" SelectionChanged="NavigationView_SelectionChanged">
                <ui:NavigationView.MenuItems>
                    <ui:NavigationViewItem x:Name="NavAudio" Content="Audio" Icon="{ui:SymbolIcon Speaker124}" Tag="Audio"/>
                    <ui:NavigationViewItem x:Name="NavAppearance" Content="Appearance" Icon="{ui:SymbolIcon Color24}" Tag="Appearance"/>
                    <ui:NavigationViewItem x:Name="NavPerformance" Content="Performance" Icon="{ui:SymbolIcon Gauge24}" Tag="Performance"/>
                    <ui:NavigationViewItem x:Name="NavDisplay" Content="Display" Icon="{ui:SymbolIcon Desktop24}" Tag="Display"/>
                    <ui:NavigationViewItem x:Name="NavEffects" Content="Effects" Icon="{ui:SymbolIcon Sparkle24}" Tag="Effects"/>
                    <ui:NavigationViewItem x:Name="NavPresets" Content="Presets" Icon="{ui:SymbolIcon Library24}" Tag="Presets"/>
                </ui:NavigationView.MenuItems>
            </ui:NavigationView>
            
            <!-- Settings Pages Container -->
            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" Padding="24,16,24,16">
                <Grid>
                    <!-- Audio Page -->
                    <StackPanel x:Name="AudioPage" Visibility="Visible">
                        <TextBlock Text="Audio Response" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Bars" FontWeight="Medium"/>
                                    <TextBlock Text="Number of frequency bars" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="BarsSlider" Width="150" Minimum="8" Maximum="256" TickFrequency="8" IsSnapToTickEnabled="True"/>
                                <ui:TextBox x:Name="BarsValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Responsiveness" FontWeight="Medium"/>
                                    <TextBlock Text="How quickly bars react to audio" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="RespSlider" Width="150" Minimum="0" Maximum="1" TickFrequency="0.05"/>
                                <ui:TextBox x:Name="RespValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Smoothing" FontWeight="Medium"/>
                                    <TextBlock Text="Smoothness of bar movement" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="SmoothSlider" Width="150" Minimum="0" Maximum="1" TickFrequency="0.05"/>
                                <ui:TextBox x:Name="SmoothValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Output Device" FontWeight="Medium"/>
                                    <TextBlock Text="Audio source to visualize" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ComboBox x:Name="AudioDeviceCombo" Width="200"/>
                        </ui:CardControl>
                    </StackPanel>

                    <!-- Appearance Page -->
                    <StackPanel x:Name="AppearancePage" Visibility="Collapsed">
                        <TextBlock Text="Appearance" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Primary Color" FontWeight="Medium"/>
                                    <TextBlock Text="Main color for the visualizer" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Border x:Name="ColorPreviewBorder" Width="32" Height="32" CornerRadius="4" Background="#00FF80"/>
                                <ui:Button x:Name="PickColorButton" Content="Pick Color" Appearance="Secondary" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <TextBlock Text="Red" FontWeight="Medium"/>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="ColorR" Width="150" Minimum="0" Maximum="255"/>
                                <ui:TextBox x:Name="ColorRValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <TextBlock Text="Green" FontWeight="Medium"/>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="ColorG" Width="150" Minimum="0" Maximum="255"/>
                                <ui:TextBox x:Name="ColorGValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <TextBlock Text="Blue" FontWeight="Medium"/>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="ColorB" Width="150" Minimum="0" Maximum="255"/>
                                <ui:TextBox x:Name="ColorBValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Color Cycling" FontWeight="Medium"/>
                                    <TextBlock Text="Automatically cycle through colors" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ui:ToggleSwitch x:Name="ColorCycleEnabled"/>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Cycle Speed" FontWeight="Medium"/>
                                    <TextBlock Text="Speed of color cycling (Hz)" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="ColorCycleSpeed" Width="150" Minimum="0" Maximum="5" TickFrequency="0.1"/>
                                <ui:TextBox x:Name="ColorCycleSpeedValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Corner Radius" FontWeight="Medium"/>
                                    <TextBlock Text="Roundness of bar corners" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="CornerRadiusSlider" Width="150" Minimum="0" Maximum="16" TickFrequency="1"/>
                                <ui:TextBox x:Name="CornerRadiusValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                    </StackPanel>

                    <!-- Performance Page -->
                    <StackPanel x:Name="PerformancePage" Visibility="Collapsed">
                        <TextBlock Text="Performance" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Rendering Mode" FontWeight="Medium"/>
                                    <TextBlock Text="CPU or GPU rendering" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ComboBox x:Name="RenderingModeCombo" Width="150">
                                <ComboBoxItem Content="CPU (WPF)" Tag="0"/>
                                <ComboBoxItem Content="GPU (SkiaSharp)" Tag="1"/>
                            </ComboBox>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Target FPS" FontWeight="Medium"/>
                                    <TextBlock Text="Frame rate limit" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="FpsSlider" Width="150" Minimum="10" Maximum="240" TickFrequency="5" IsSnapToTickEnabled="True"/>
                                <ui:TextBox x:Name="FpsValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Profile" FontWeight="Medium"/>
                                    <TextBlock Text="Preset performance profiles" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ComboBox x:Name="ProfileCombo" Width="150">
                                <ComboBoxItem Content="Custom" Tag="custom"/>
                                <ComboBoxItem Content="Smooth" Tag="smooth"/>
                                <ComboBoxItem Content="Balanced" Tag="balanced"/>
                                <ComboBoxItem Content="Low latency" Tag="low"/>
                            </ComboBox>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Fade on Silence" FontWeight="Medium"/>
                                    <TextBlock Text="Fade out when no audio" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ui:ToggleSwitch x:Name="FadeOnSilenceEnabledCheckBox"/>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <TextBlock Text="Fade Out Duration (s)" FontWeight="Medium"/>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="FadeOutSlider" Width="150" Minimum="0.1" Maximum="5" TickFrequency="0.1"/>
                                <ui:TextBox x:Name="FadeOutValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <TextBlock Text="Fade In Duration (s)" FontWeight="Medium"/>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="FadeInSlider" Width="150" Minimum="0.1" Maximum="5" TickFrequency="0.1"/>
                                <ui:TextBox x:Name="FadeInValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                    </StackPanel>

                    <!-- Display Page -->
                    <StackPanel x:Name="DisplayPage" Visibility="Collapsed">
                        <TextBlock Text="Display" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Display Mode" FontWeight="Medium"/>
                                    <TextBlock Text="Which monitors to show on" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <ComboBox x:Name="DisplayModeCombo" Width="160">
                                    <ComboBoxItem Content="All monitors" Tag="0"/>
                                    <ComboBoxItem Content="Primary only" Tag="1"/>
                                    <ComboBoxItem Content="Specific monitor" Tag="2"/>
                                </ComboBox>
                                <ui:Button x:Name="RefreshMonitorsButton" Icon="{ui:SymbolIcon ArrowSync24}" ToolTip="Refresh" Margin="8,0,0,0" Click="RefreshMonitorsButton_Click"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <TextBlock Text="Monitor" FontWeight="Medium"/>
                            </ui:CardControl.Header>
                            <ComboBox x:Name="MonitorCombo" Width="200" IsEnabled="False"/>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Visualizer Mode" FontWeight="Medium"/>
                                    <TextBlock Text="Bar style or circular" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ComboBox x:Name="VisualizerModeCombo" Width="150">
                                <ComboBoxItem Content="Bars" Tag="0"/>
                                <ComboBoxItem Content="Circular" Tag="1"/>
                            </ComboBox>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Circle Diameter" FontWeight="Medium"/>
                                    <TextBlock Text="Size for circular mode" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="CircleDiameterSlider" Width="150" Minimum="100" Maximum="2000" TickFrequency="50"/>
                                <ui:TextBox x:Name="CircleDiameterValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                    </StackPanel>

                    <!-- Effects Page -->
                    <StackPanel x:Name="EffectsPage" Visibility="Collapsed">
                        <TextBlock Text="Effects" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Bass Emphasis" FontWeight="Medium"/>
                                    <TextBlock Text="Boost low frequencies" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="BassEmphasisSlider" Width="150" Minimum="0" Maximum="2" TickFrequency="0.1"/>
                                <ui:TextBox x:Name="BassEmphasisValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Treble Emphasis" FontWeight="Medium"/>
                                    <TextBlock Text="Boost high frequencies" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="TrebleEmphasisSlider" Width="150" Minimum="0" Maximum="2" TickFrequency="0.1"/>
                                <ui:TextBox x:Name="TrebleEmphasisValue" Width="50" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Glow Effect" FontWeight="Medium"/>
                                    <TextBlock Text="Soft glow behind bars" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ui:ToggleSwitch x:Name="GlowEnabledCheckBox"/>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Beat Pulse" FontWeight="Medium"/>
                                    <TextBlock Text="Pulse on beat detection" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ui:ToggleSwitch x:Name="BeatShapeEnabledCheckBox"/>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Gradient" FontWeight="Medium"/>
                                    <TextBlock Text="Bass-to-treble color gradient" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <ui:ToggleSwitch x:Name="GradientEnabledCheckBox"/>
                        </ui:CardControl>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <TextBlock Text="Gradient End Color" FontWeight="Medium"/>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <Slider x:Name="GradientEndR" Width="60" Minimum="0" Maximum="255" ToolTip="Red"/>
                                <Slider x:Name="GradientEndG" Width="60" Minimum="0" Maximum="255" ToolTip="Green" Margin="4,0"/>
                                <Slider x:Name="GradientEndB" Width="60" Minimum="0" Maximum="255" ToolTip="Blue"/>
                                <Border x:Name="GradientPreview" Width="32" Height="24" CornerRadius="4" BorderThickness="1" Margin="8,0,0,0"/>
                            </StackPanel>
                        </ui:CardControl>
                    </StackPanel>

                    <!-- Presets Page -->
                    <StackPanel x:Name="PresetsPage" Visibility="Collapsed">
                        <TextBlock Text="Theme Presets" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        <ui:CardControl Margin="0,0,0,12">
                            <ui:CardControl.Header>
                                <StackPanel>
                                    <TextBlock Text="Select Preset" FontWeight="Medium"/>
                                    <TextBlock Text="Apply a predefined theme" Opacity="0.6" FontSize="12"/>
                                </StackPanel>
                            </ui:CardControl.Header>
                            <StackPanel Orientation="Horizontal">
                                <ComboBox x:Name="ThemePresetCombo" Width="180" SelectionChanged="ThemePresetCombo_SelectionChanged"/>
                                <ui:Button x:Name="ApplyPresetButton" Content="Apply" Appearance="Primary" Margin="8,0,0,0" Click="ApplyPresetButton_Click"/>
                            </StackPanel>
                        </ui:CardControl>
                    </StackPanel>
                </Grid>
            </ScrollViewer>
        </Grid>
        
        <!-- Status Bar -->
        <Border Grid.Row="2" Background="{ui:ThemeResource ControlFillColorDefaultBrush}" Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="CpuUsageText" Text="CPU: --%" Opacity="0.7" FontSize="12" Margin="0,0,12,0"/>
                    <TextBlock x:Name="GpuUsageText" Text="GPU: --%" Opacity="0.7" FontSize="12" Margin="0,0,12,0"/>
                    <TextBlock x:Name="MemoryUsageText" Text="RAM: -- MB" Opacity="0.7" FontSize="12" Margin="0,0,12,0"/>
                    <TextBlock x:Name="FpsText" Text="FPS: --" Opacity="0.7" FontSize="12" Margin="0,0,12,0"/>
                    <TextBlock x:Name="LatencyText" Text="Latency: -- ms" Foreground="#FF8800" FontSize="12"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <ui:Button x:Name="CancelButton" Content="Cancel" Appearance="Secondary" Width="90" Margin="0,0,8,0"/>
                    <ui:Button x:Name="SaveButton" Content="Save" Appearance="Primary" Width="90"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</ui:FluentWindow>
